<div class="container mx-auto p-4 sm:p-6">
  <div *ngIf="isLoading" class="text-center py-10">
    <svg
      class="animate-spin h-8 w-8 text-indigo-600 mx-auto"
      fill="none"
      viewBox="0 0 24 24"
    >
      <circle
        class="opacity-25"
        cx="12"
        cy="12"
        r="10"
        stroke="currentColor"
        stroke-width="4"
      ></circle>
      <path
        class="opacity-75"
        fill="currentColor"
        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
      ></path>
    </svg>
    <p class="text-gray-500 mt-2">Loading Team Data...</p>
  </div>

  <div *ngIf="!isLoading">
    <div *ngIf="team">
      <h1 class="text-3xl font-bold mb-6 text-gray-800">
        Dashboard for <span class="text-indigo-600">{{ team.name }}</span>
      </h1>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-sm text-gray-500">Total Tasks</p>
          <p class="text-2xl font-bold text-gray-800">{{ tasks.length }}</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-sm text-gray-500">In Progress</p>
          <p class="text-2xl font-bold text-gray-800">
            {{ getTaskCountByStatus(tasks, "IN_PROGRESS") }}
          </p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-sm text-gray-500">Overdue</p>
          <p class="text-2xl font-bold text-red-500">{{ overdueTasksCount }}</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
          <p class="text-sm text-gray-500">Team Members</p>
          <p class="text-2xl font-bold text-gray-800">
            {{ team.members.length }}
          </p>
        </div>
      </div>

      <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">
          Member Workload (Pending Tasks)
        </h2>
        <div
          *ngIf="workloadChartData?.datasets?.[0]?.data?.length; else noDataChart"
          class="relative w-full h-96"
        >
          <canvas
            baseChart
            [data]="workloadChartData"
            [type]="'bar'"
            [options]="workloadChartOptions"
          ></canvas>
        </div>
        <ng-template #noDataChart
          ><div class="text-center text-gray-500 py-10">
            No pending tasks to display.
          </div></ng-template
        >
      </div>
    </div>

    <div
      *ngIf="teamNotFoundError"
      class="text-center bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-6 rounded-lg shadow-md mt-6"
    >
      <h2 class="text-2xl font-bold">No Team Assigned</h2>
      <p class="mt-2">
        Please contact an administrator to be assigned as a lead to a team.
      </p>
    </div>
  </div>
</div>
