<div class="flex h-screen bg-gray-100">
  <div
    *ngIf="isSidebarOpen"
    (click)="toggleSidebar()"
    class="fixed inset-0 bg-gray-900/75 z-20 md:hidden"
  ></div>
  <aside
    *ngIf="isLoggedIn && currentUser"
    class="bg-white text-gray-800 w-64 flex-shrink-0 shadow-lg flex flex-col fixed inset-y-0 left-0 z-30 transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0"
    [ngClass]="{
      'translate-x-0': isSidebarOpen,
      '-translate-x-full': !isSidebarOpen
    }"
  >
    <div
      class="h-16 flex items-center justify-center border-b border-gray-200 flex-shrink-0"
    >
      <a
        [routerLink]="getDashboardLink()"
        class="text-2xl font-bold text-indigo-600 flex items-center"
      >
        <svg
          class="w-8 h-8 mr-2"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.243 0 2.25 1.007 2.25 2.25v.007A48.49 48.49 0 0116.5 9.75c-.631 0-1.262-.05-1.88-.145a48.46 48.46 0 00-2.12 0c-.618.095-1.244.145-1.88.145a48.49 48.49 0 01-1.612-3.423V6.108c0-1.243 1.007-2.25 2.25-2.25h1.5c.622 0 1.18.252 1.591.664z"
          />
        </svg>
        <span>CollabDesk</span>
      </a>
    </div>

    <nav class="flex-grow pt-5">
      <ng-container *ngIf="currentUser.role === 'ADMIN'">
        <a
          routerLink="/admin/dashboard"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Dashboard</span>
        </a>
        <a
          routerLink="/admin/users"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A5.975 5.975 0 0112 13a5.975 5.975 0 013 1.803M15 21a9 9 0 00-5.657-8.386M12 13a4 4 0 110-8 4 4 0 010 8z"
            ></path>
          </svg>
          <span class="ml-3 font-medium">User Management</span>
        </a>
        <a
          routerLink="/admin/teams"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Team Management</span>
        </a>
        <a
          routerLink="/admin/tasks"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
            ></path>
          </svg>
          <span class="ml-3 font-medium">All Tasks</span>
        </a>
        <a
          routerLink="/admin/logs"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Application Logs</span>
        </a>
      </ng-container>

      <ng-container *ngIf="currentUser.role === 'TEAM_LEAD'">
        <a
          routerLink="/team-lead/dashboard"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Dashboard</span>
        </a>
        <a
          routerLink="/team-lead/my-tasks"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            ></path>
          </svg>
          <span class="ml-3 font-medium">My Tasks</span>
        </a>
        <a
          routerLink="/team-lead/tasks"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Task Management</span>
        </a>
        <a
          routerLink="/team-lead/members"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
            ></path>
          </svg>
          <span class="ml-3 font-medium">Manage Members</span>
        </a>
      </ng-container>

      <ng-container *ngIf="currentUser.role === 'MEMBER'">
        <a
          routerLink="/member/my-tasks"
          routerLinkActive="bg-indigo-50 text-indigo-600 border-l-4 border-indigo-500"
          class="flex items-center px-4 py-3 text-gray-600 hover:bg-indigo-50 transition-colors duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
            ></path>
          </svg>
          <span class="ml-3 font-medium">My Tasks</span>
        </a>
      </ng-container>
    </nav>

    <div class="p-4 border-t border-gray-200 flex-shrink-0">
      <button
        (click)="logout()"
        class="w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors duration-200"
      >
        <svg
          class="w-5 h-5 mr-3"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
          ></path>
        </svg>
        Logout
      </button>
    </div>
  </aside>

  <div class="flex-1 flex flex-col">
    <app-header (toggleSidebarEvent)="toggleSidebar()"></app-header>
    <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100">
      <router-outlet></router-outlet>
    </main>
    <app-footer *ngIf="isLoggedIn"></app-footer>
  </div>
</div>
